# Simulation of SHE with positivity-preserving splitting scheme

![3D Plot of u(t,x)](Demo_2-1_3d.png)

<video controls src="Demo_2-1_2d.mp4" title="2D Animation of u(t,x)"></video>

The goal of this repository is to simulate the Stochastic Heat Equation (SHE) on the spatial domain (0,1) with homogeneous Dirichlet boundary conditions, using a positivity-preserving splitting scheme. Outputs are presented as 3D plots and MP4 animations.

## Reference

These MATLAB scripts support the results published in

Bréhier, Charles-Edouard; Cohen, David; Ulander, Johan.
"Analysis of a positivity-preserving splitting scheme for some semilinear
stochastic heat equations." *ESAIM: Mathematical Modelling and Numerical
Analysis* 58(4):1317–1346, 2024. DOI:
<https://doi.org/10.1051/m2an/2024032>.

Some functions were translated from the original MATLAB code available at [Zenodo](https://zenodo.org/records/10300733) to Python.

Further background and a brief podcast discussion can be found in the
official reference entry at
<https://spdes-bib.readthedocs.io/en/latest/bib_entries/brehier.cohen.ea:24:analysis.html>.

## Usage

To install and run this project, follow these steps:

1.  **Clone the repository:**

    ```bash
    git clone https://github.com/lzc0090/SHE_Positive-preserving_Simulation.git
    cd SHE_Positive-preserving_Simulation
    ```

2.  **Install the package:**

    ```bash
    pip install .
    ```

3.  **Run the simulation:**

    To run the simulation with default parameters and generate plots, use the following command:

    ```bash
    she-sim
    ```

    You can also customize the simulation using command-line arguments or a YAML configuration file.

### Command-line Arguments

    ```bash
    she-sim --seed <seed> --samples <samples> --output <output_prefix> --alphaN <alphaN> --T <T> --discretization_level <discretization_level> --fps <fps> --max_animation_frames <max_animation_frames> --no-plot
    ```

    -   `--seed`: Random seed for the simulation (default: 93).
    -   `--samples`: Number of Monte Carlo samples (default: 4).
    -   `--output`: Prefix for the output file names (default: `msSupDxDt`).
    -   `--alphaN`: Noise strength parameter (default: 1.0).
    -   `--T`: End time of the simulation (default: 0.5).
    -   `--discretization_level`: Level of spatial discretization (default: 10). The spatial step size `h` is calculated as `2**(-discretization_level)`.
    -   `--fps`: Frames per second for the animation (default: 10).
    -   `--max_animation_frames`: Maximum number of frames for the animation (default: 120).
    -   `--no-plot`: Suppress the generation of plots.

### Configuration File

You can also provide a YAML configuration file using the `--config` option. Command-line arguments will override values specified in the configuration file.

Example `she-sim-config.yaml`:

```yaml
seed: 123
samples: 10
output: custom_output
alphaN: 0.8
T: 1.0
discretization_level: 8
fps: 15
no-plot: false
```

To run with a configuration file:

```bash
she-sim --config she-sim-config.yaml
```

Note: The `Demo_2-1_3d.png` and `Demo_2-1_2d.mp4` files displayed at the top of this README are generated by running the `demo.sh` script, which uses the `she-sim-config.yaml` configuration.

### Generated Output Files

Running the simulation will generate `.npz`, `.png`, and `.mp4` files in the root directory. These files are generated by the `demo.sh` script (or by running `she-sim` directly).

-   `.npz` files: Contain the simulation data.
-   `.png` files: 3D plots of the simulation results (e.g., `msSupDxDt_sample_1_3d.png`).
-   `.mp4` files: 2D animations of the simulation results (e.g., `msSupDxDt_sample_1_2d.mp4`).

## License

[CC BY 4.0](https://creativecommons.org/licenses/by/4.0/)

The code is translated from Matlab to Python by Le Chen. Le Chen would like to thank David Cohen for his help in understanding the original MATLAB code.

